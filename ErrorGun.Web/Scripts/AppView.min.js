var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},ErrorGun;(function(n){(function(t){var i=function(t){function i(){var i=this;t.call(this),this.ApiKey=ko.observable(""),this.AppLoaded=ko.observable(!1),this.Working=ko.observable(!1),this.ReportedErrorId=ko.observable(""),this.ErrorMessageSend=ko.observable(""),this.Message=ko.observable(""),this.Detail=ko.observable(""),this.Category=ko.observable(""),this.Source=ko.observable(""),this.UserEmail=ko.observable(""),this.ErrorReportPage=ko.observable(1),this.ErrorReportPageCount=ko.observable(0),this.ErrorReports=ko.observableArray([]),this.ContactEmailsFlat=ko.computed(function(){return i.ContactEmails().join(", ")}),this.LoadApp=function(){i._loadedApiKey!==i.ApiKey()&&(i._loadedApiKey="",i.AppLoaded(!1),$.getJSON("/api/apps",{apiKey:i.ApiKey()}).fail(function(t){var r=n.ErrorCodes.GetErrorMessages(t.responseText);i.ErrorMessage(r)}).done(function(n){i._loadedApiKey=n.ApiKey,i.Id(n.Id),i.Name(n.Name),i.CreatedTimestampUtc(moment(n.CreatedTimestampUtc).format("YYYY MMM DD hh:mm A")),i.ContactEmails(n.ContactEmails),i.ErrorMessage(""),i.AppLoaded(!0)}))},this.LoadErrors=function(){i.AppLoaded()===!0&&$.getJSON("/api/errors",{apiKey:i.ApiKey(),pageIndex:i.ErrorReportPage()-1,pageSize:4}).fail(function(t){var r=n.ErrorCodes.GetErrorMessages(t.responseText);i.ErrorMessage(r)}).done(function(n){i.ErrorReportPageCount(n.PageCount),$.each(n.Items,function(n,t){t.ReportedTimestampUtc=moment(t.ReportedTimestampUtc).format("YYYY MMM DD hh:mm A")}),i.ErrorReports(n.Items)})},this.SendTestErrorReport=function(){if(i.AppLoaded()===!0){i.ReportedErrorId("");var t={AppId:i.Id(),ApiKey:i.ApiKey(),Message:i.Message(),Detail:i.Detail(),Category:i.Category(),Source:i.Source(),UserEmail:i.UserEmail()};$.ajax({url:"/api/errors?apiKey="+i.ApiKey(),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(t)}).fail(function(t){var r=n.ErrorCodes.GetErrorMessages(t.responseText);i.ErrorMessageSend(r)}).done(function(n){i.ErrorMessageSend(""),i.ReportedErrorId(n.Id)})}},this.ClearErrorReport=function(){i.Message(""),i.Detail(""),i.Category(""),i.Source(""),i.UserEmail("")},this.PrevErrorReportPage=function(){var n=Math.max(1,i.ErrorReportPage()-1);i.ErrorReportPage(n),i.LoadErrors()},this.NextErrorReportPage=function(){var n=Math.min(i.ErrorReportPageCount(),i.ErrorReportPage()+1);i.ErrorReportPage(n),i.LoadErrors()}}return __extends(i,t),i}(t.App);t.AppView=i})(n.ViewModels||(n.ViewModels={}));var t=n.ViewModels})(ErrorGun||(ErrorGun={}))